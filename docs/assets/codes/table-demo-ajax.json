{"highlightCode":"<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> HttpClient<span class=\"token punctuation\">,</span> HttpParams <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/common/http'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> Injectable<span class=\"token punctuation\">,</span> OnInit <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/core'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Observable<span class=\"token punctuation\">,</span> of <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'rxjs'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> catchError <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'rxjs/operators'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> NzTableQueryParams <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'ng-zorro-antd/table'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">RandomUser</span> <span class=\"token punctuation\">{</span>\r\n  gender<span class=\"token punctuation\">:</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">;</span>\r\n  email<span class=\"token punctuation\">:</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">;</span>\r\n  name<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\r\n    title<span class=\"token punctuation\">:</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">;</span>\r\n    first<span class=\"token punctuation\">:</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">;</span>\r\n    last<span class=\"token punctuation\">:</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n@<span class=\"token function\">Injectable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> providedIn<span class=\"token punctuation\">:</span> <span class=\"token string\">'root'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">RandomUserService</span> <span class=\"token punctuation\">{</span>\r\n  randomUserUrl <span class=\"token operator\">=</span> <span class=\"token string\">'https://api.randomuser.me/'</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token function\">getUsers</span><span class=\"token punctuation\">(</span>\r\n    pageIndex<span class=\"token punctuation\">:</span> <span class=\"token keyword\">number</span><span class=\"token punctuation\">,</span>\r\n    pageSize<span class=\"token punctuation\">:</span> <span class=\"token keyword\">number</span><span class=\"token punctuation\">,</span>\r\n    sortField<span class=\"token punctuation\">:</span> <span class=\"token keyword\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\r\n    sortOrder<span class=\"token punctuation\">:</span> <span class=\"token keyword\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\r\n    filters<span class=\"token punctuation\">:</span> <span class=\"token keyword\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span> key<span class=\"token punctuation\">:</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">;</span> value<span class=\"token punctuation\">:</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\r\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Observable<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span> results<span class=\"token punctuation\">:</span> RandomUser<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">let</span> params <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpParams</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'page'</span><span class=\"token punctuation\">,</span> `$<span class=\"token punctuation\">{</span>pageIndex<span class=\"token punctuation\">}</span>`<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'results'</span><span class=\"token punctuation\">,</span> `$<span class=\"token punctuation\">{</span>pageSize<span class=\"token punctuation\">}</span>`<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sortField'</span><span class=\"token punctuation\">,</span> `$<span class=\"token punctuation\">{</span>sortField<span class=\"token punctuation\">}</span>`<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'sortOrder'</span><span class=\"token punctuation\">,</span> `$<span class=\"token punctuation\">{</span>sortOrder<span class=\"token punctuation\">}</span>`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    filters<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>filter <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\r\n      filter<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\r\n        params <span class=\"token operator\">=</span> params<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>filter<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>http\r\n      <span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span> results<span class=\"token punctuation\">:</span> RandomUser<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>`$<span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>randomUserUrl<span class=\"token punctuation\">}</span>`<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> params <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span><span class=\"token function\">catchError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token function\">of</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> results<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">private</span> http<span class=\"token punctuation\">:</span> HttpClient<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n  selector<span class=\"token punctuation\">:</span> <span class=\"token string\">'nz-demo-table-ajax'</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token template-string\">template: <span class=\"token html\">`\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>nz-table</span>\r\n      <span class=\"token attr-name\">nzShowSizeChanger</span>\r\n      <span class=\"token attr-name\">[nzData]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>listOfRandomUser<span class=\"token punctuation\">\"</span></span>\r\n      <span class=\"token attr-name\">[nzFrontPagination]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>false<span class=\"token punctuation\">\"</span></span>\r\n      <span class=\"token attr-name\">[nzLoading]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>loading<span class=\"token punctuation\">\"</span></span>\r\n      <span class=\"token attr-name\">[nzTotal]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>total<span class=\"token punctuation\">\"</span></span>\r\n      <span class=\"token attr-name\">[nzPageSize]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>pageSize<span class=\"token punctuation\">\"</span></span>\r\n      <span class=\"token attr-name\">[nzPageIndex]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>pageIndex<span class=\"token punctuation\">\"</span></span>\r\n      <span class=\"token attr-name\">(nzQueryParams)</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>onQueryParamsChange($event)<span class=\"token punctuation\">\"</span></span>\r\n    <span class=\"token punctuation\">></span></span>\r\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>thead</span><span class=\"token punctuation\">></span></span>\r\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span><span class=\"token punctuation\">></span></span>\r\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>th</span> <span class=\"token attr-name\">nzColumnKey</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">[nzSortFn]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Name<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>th</span><span class=\"token punctuation\">></span></span>\r\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>th</span> <span class=\"token attr-name\">nzColumnKey</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>gender<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">[nzFilters]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>filterGender<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">[nzFilterFn]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Gender<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>th</span><span class=\"token punctuation\">></span></span>\r\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>th</span> <span class=\"token attr-name\">nzColumnKey</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>email<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">[nzSortFn]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Email<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>th</span><span class=\"token punctuation\">></span></span>\r\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span>\r\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>thead</span><span class=\"token punctuation\">></span></span>\r\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tbody</span><span class=\"token punctuation\">></span></span>\r\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span> <span class=\"token attr-name\">*ngFor</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>let data of listOfRandomUser<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>{{ data.name.first }} {{ data.name.last }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span>\r\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>{{ data.gender }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span>\r\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>td</span><span class=\"token punctuation\">></span></span>{{ data.email }}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>td</span><span class=\"token punctuation\">></span></span>\r\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span>\r\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tbody</span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>nz-table</span><span class=\"token punctuation\">></span></span>\r\n  `</span></span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">NzDemoTableAjaxComponent</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">OnInit</span> <span class=\"token punctuation\">{</span>\r\n  total <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n  listOfRandomUser<span class=\"token punctuation\">:</span> RandomUser<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n  loading <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">;</span>\r\n  pageSize <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\r\n  pageIndex <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n  filterGender <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n    <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">:</span> <span class=\"token string\">'male'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> <span class=\"token string\">'female'</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">:</span> <span class=\"token string\">'female'</span> <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token function\">loadDataFromServer</span><span class=\"token punctuation\">(</span>\r\n    pageIndex<span class=\"token punctuation\">:</span> <span class=\"token keyword\">number</span><span class=\"token punctuation\">,</span>\r\n    pageSize<span class=\"token punctuation\">:</span> <span class=\"token keyword\">number</span><span class=\"token punctuation\">,</span>\r\n    sortField<span class=\"token punctuation\">:</span> <span class=\"token keyword\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\r\n    sortOrder<span class=\"token punctuation\">:</span> <span class=\"token keyword\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\r\n    filter<span class=\"token punctuation\">:</span> <span class=\"token keyword\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span> key<span class=\"token punctuation\">:</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">;</span> value<span class=\"token punctuation\">:</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\r\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>loading <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>randomUserService<span class=\"token punctuation\">.</span><span class=\"token function\">getUsers</span><span class=\"token punctuation\">(</span>pageIndex<span class=\"token punctuation\">,</span> pageSize<span class=\"token punctuation\">,</span> sortField<span class=\"token punctuation\">,</span> sortOrder<span class=\"token punctuation\">,</span> filter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span>data <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>loading <span class=\"token operator\">=</span> <span class=\"token keyword\">false</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>total <span class=\"token operator\">=</span> <span class=\"token number\">200</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">// mock the total data here</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>listOfRandomUser <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>results<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token function\">onQueryParamsChange</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">:</span> NzTableQueryParams<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> pageSize<span class=\"token punctuation\">,</span> pageIndex<span class=\"token punctuation\">,</span> sort<span class=\"token punctuation\">,</span> filter <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> params<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> currentSort <span class=\"token operator\">=</span> sort<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>item <span class=\"token operator\">=</span><span class=\"token operator\">></span> item<span class=\"token punctuation\">.</span>value <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> sortField <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>currentSort <span class=\"token operator\">&amp;&amp;</span> currentSort<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> sortOrder <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>currentSort <span class=\"token operator\">&amp;&amp;</span> currentSort<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">loadDataFromServer</span><span class=\"token punctuation\">(</span>pageIndex<span class=\"token punctuation\">,</span> pageSize<span class=\"token punctuation\">,</span> sortField<span class=\"token punctuation\">,</span> sortOrder<span class=\"token punctuation\">,</span> filter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">private</span> randomUserService<span class=\"token punctuation\">:</span> RandomUserService<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token function\">ngOnInit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">loadDataFromServer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pageIndex<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pageSize<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n","rawCode":"import { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { Component, Injectable, OnInit } from '@angular/core';\r\nimport { Observable, of } from 'rxjs';\r\nimport { catchError } from 'rxjs/operators';\r\n\r\nimport { NzTableQueryParams } from 'ng-zorro-antd/table';\r\n\r\ninterface RandomUser {\r\n  gender: string;\r\n  email: string;\r\n  name: {\r\n    title: string;\r\n    first: string;\r\n    last: string;\r\n  };\r\n}\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class RandomUserService {\r\n  randomUserUrl = 'https://api.randomuser.me/';\r\n\r\n  getUsers(\r\n    pageIndex: number,\r\n    pageSize: number,\r\n    sortField: string | null,\r\n    sortOrder: string | null,\r\n    filters: Array<{ key: string; value: string[] }>\r\n  ): Observable<{ results: RandomUser[] }> {\r\n    let params = new HttpParams()\r\n      .append('page', `${pageIndex}`)\r\n      .append('results', `${pageSize}`)\r\n      .append('sortField', `${sortField}`)\r\n      .append('sortOrder', `${sortOrder}`);\r\n    filters.forEach(filter => {\r\n      filter.value.forEach(value => {\r\n        params = params.append(filter.key, value);\r\n      });\r\n    });\r\n    return this.http\r\n      .get<{ results: RandomUser[] }>(`${this.randomUserUrl}`, { params })\r\n      .pipe(catchError(() => of({ results: [] })));\r\n  }\r\n\r\n  constructor(private http: HttpClient) {}\r\n}\r\n\r\n@Component({\r\n  selector: 'nz-demo-table-ajax',\r\n  template: `\r\n    <nz-table\r\n      nzShowSizeChanger\r\n      [nzData]=\"listOfRandomUser\"\r\n      [nzFrontPagination]=\"false\"\r\n      [nzLoading]=\"loading\"\r\n      [nzTotal]=\"total\"\r\n      [nzPageSize]=\"pageSize\"\r\n      [nzPageIndex]=\"pageIndex\"\r\n      (nzQueryParams)=\"onQueryParamsChange($event)\"\r\n    >\r\n      <thead>\r\n        <tr>\r\n          <th nzColumnKey=\"name\" [nzSortFn]=\"true\">Name</th>\r\n          <th nzColumnKey=\"gender\" [nzFilters]=\"filterGender\" [nzFilterFn]=\"true\">Gender</th>\r\n          <th nzColumnKey=\"email\" [nzSortFn]=\"true\">Email</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr *ngFor=\"let data of listOfRandomUser\">\r\n          <td>{{ data.name.first }} {{ data.name.last }}</td>\r\n          <td>{{ data.gender }}</td>\r\n          <td>{{ data.email }}</td>\r\n        </tr>\r\n      </tbody>\r\n    </nz-table>\r\n  `\r\n})\r\nexport class NzDemoTableAjaxComponent implements OnInit {\r\n  total = 1;\r\n  listOfRandomUser: RandomUser[] = [];\r\n  loading = true;\r\n  pageSize = 10;\r\n  pageIndex = 1;\r\n  filterGender = [\r\n    { text: 'male', value: 'male' },\r\n    { text: 'female', value: 'female' }\r\n  ];\r\n\r\n  loadDataFromServer(\r\n    pageIndex: number,\r\n    pageSize: number,\r\n    sortField: string | null,\r\n    sortOrder: string | null,\r\n    filter: Array<{ key: string; value: string[] }>\r\n  ): void {\r\n    this.loading = true;\r\n    this.randomUserService.getUsers(pageIndex, pageSize, sortField, sortOrder, filter).subscribe(data => {\r\n      this.loading = false;\r\n      this.total = 200; // mock the total data here\r\n      this.listOfRandomUser = data.results;\r\n    });\r\n  }\r\n\r\n  onQueryParamsChange(params: NzTableQueryParams): void {\r\n    console.log(params);\r\n    const { pageSize, pageIndex, sort, filter } = params;\r\n    const currentSort = sort.find(item => item.value !== null);\r\n    const sortField = (currentSort && currentSort.key) || null;\r\n    const sortOrder = (currentSort && currentSort.value) || null;\r\n    this.loadDataFromServer(pageIndex, pageSize, sortField, sortOrder, filter);\r\n  }\r\n\r\n  constructor(private randomUserService: RandomUserService) {}\r\n\r\n  ngOnInit(): void {\r\n    this.loadDataFromServer(this.pageIndex, this.pageSize, null, null, []);\r\n  }\r\n}\r\n"}
