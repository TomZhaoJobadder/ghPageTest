{"highlightCode":"<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@angular/core'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> NzUploadFile <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'ng-zorro-antd/upload'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> getBase64 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">:</span> File<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Promise<span class=\"token operator\">&lt;</span><span class=\"token keyword\">string</span> <span class=\"token operator\">|</span> ArrayBuffer <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span><span class=\"token operator\">></span>\r\n  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> reader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    reader<span class=\"token punctuation\">.</span><span class=\"token function\">readAsDataURL</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    reader<span class=\"token punctuation\">.</span>onload <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    reader<span class=\"token punctuation\">.</span>onerror <span class=\"token operator\">=</span> error <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n@<span class=\"token function\">Component</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n  selector<span class=\"token punctuation\">:</span> <span class=\"token string\">'nz-demo-upload-picture-card'</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token template-string\">template: <span class=\"token html\">`\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>clearfix<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>nz-upload</span>\r\n        <span class=\"token attr-name\">nzAction</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://www.mocky.io/v2/5cc8019d300000980a055e76<span class=\"token punctuation\">\"</span></span>\r\n        <span class=\"token attr-name\">nzListType</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>picture-card<span class=\"token punctuation\">\"</span></span>\r\n        <span class=\"token attr-name\">[(nzFileList)]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>fileList<span class=\"token punctuation\">\"</span></span>\r\n        <span class=\"token attr-name\">[nzShowButton]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>fileList.length &lt; 8<span class=\"token punctuation\">\"</span></span>\r\n        <span class=\"token attr-name\">[nzPreview]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>handlePreview<span class=\"token punctuation\">\"</span></span>\r\n      <span class=\"token punctuation\">></span></span>\r\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\r\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">nz-icon</span> <span class=\"token attr-name\">nzType</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>plus<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\r\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">margin-top</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8</span>px</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Upload<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\r\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\r\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>nz-upload</span><span class=\"token punctuation\">></span></span>\r\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>nz-modal</span>\r\n        <span class=\"token attr-name\">[nzVisible]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>previewVisible<span class=\"token punctuation\">\"</span></span>\r\n        <span class=\"token attr-name\">[nzContent]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>modalContent<span class=\"token punctuation\">\"</span></span>\r\n        <span class=\"token attr-name\">[nzFooter]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>null<span class=\"token punctuation\">\"</span></span>\r\n        <span class=\"token attr-name\">(nzOnCancel)</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>previewVisible <span class=\"token punctuation\">=</span> false<span class=\"token punctuation\">\"</span></span>\r\n      <span class=\"token punctuation\">></span></span>\r\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ng-template</span> <span class=\"token attr-name\">#modalContent</span><span class=\"token punctuation\">></span></span>\r\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">[src]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>previewImage<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">[ngStyle]</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{ width: <span class=\"token punctuation\">'</span>100%<span class=\"token punctuation\">'</span> }<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\r\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ng-template</span><span class=\"token punctuation\">></span></span>\r\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>nz-modal</span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\r\n  `</span></span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">NzDemoUploadPictureCardComponent</span> <span class=\"token punctuation\">{</span>\r\n  fileList<span class=\"token punctuation\">:</span> NzUploadFile<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n    <span class=\"token punctuation\">{</span>\r\n      uid<span class=\"token punctuation\">:</span> <span class=\"token string\">'-1'</span><span class=\"token punctuation\">,</span>\r\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'image.png'</span><span class=\"token punctuation\">,</span>\r\n      status<span class=\"token punctuation\">:</span> <span class=\"token string\">'done'</span><span class=\"token punctuation\">,</span>\r\n      url<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png'</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">{</span>\r\n      uid<span class=\"token punctuation\">:</span> <span class=\"token string\">'-2'</span><span class=\"token punctuation\">,</span>\r\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'image.png'</span><span class=\"token punctuation\">,</span>\r\n      status<span class=\"token punctuation\">:</span> <span class=\"token string\">'done'</span><span class=\"token punctuation\">,</span>\r\n      url<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png'</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">{</span>\r\n      uid<span class=\"token punctuation\">:</span> <span class=\"token string\">'-3'</span><span class=\"token punctuation\">,</span>\r\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'image.png'</span><span class=\"token punctuation\">,</span>\r\n      status<span class=\"token punctuation\">:</span> <span class=\"token string\">'done'</span><span class=\"token punctuation\">,</span>\r\n      url<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png'</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">{</span>\r\n      uid<span class=\"token punctuation\">:</span> <span class=\"token string\">'-4'</span><span class=\"token punctuation\">,</span>\r\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'image.png'</span><span class=\"token punctuation\">,</span>\r\n      status<span class=\"token punctuation\">:</span> <span class=\"token string\">'done'</span><span class=\"token punctuation\">,</span>\r\n      url<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png'</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">{</span>\r\n      uid<span class=\"token punctuation\">:</span> <span class=\"token string\">'-xxx'</span><span class=\"token punctuation\">,</span>\r\n      percent<span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span>\r\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'image.png'</span><span class=\"token punctuation\">,</span>\r\n      status<span class=\"token punctuation\">:</span> <span class=\"token string\">'uploading'</span><span class=\"token punctuation\">,</span>\r\n      url<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png'</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">{</span>\r\n      uid<span class=\"token punctuation\">:</span> <span class=\"token string\">'-5'</span><span class=\"token punctuation\">,</span>\r\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">'image.png'</span><span class=\"token punctuation\">,</span>\r\n      status<span class=\"token punctuation\">:</span> <span class=\"token string\">'error'</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n  previewImage<span class=\"token punctuation\">:</span> <span class=\"token keyword\">string</span> <span class=\"token operator\">|</span> undefined <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\r\n  previewVisible <span class=\"token operator\">=</span> <span class=\"token keyword\">false</span><span class=\"token punctuation\">;</span>\r\n\r\n  handlePreview <span class=\"token operator\">=</span> async <span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">:</span> NzUploadFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Promise<span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>file<span class=\"token punctuation\">.</span>url <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>file<span class=\"token punctuation\">.</span>preview<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      file<span class=\"token punctuation\">.</span>preview <span class=\"token operator\">=</span> await <span class=\"token function\">getBase64</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">.</span>originFileObj<span class=\"token operator\">!</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>previewImage <span class=\"token operator\">=</span> file<span class=\"token punctuation\">.</span>url <span class=\"token operator\">||</span> file<span class=\"token punctuation\">.</span>preview<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>previewVisible <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n","rawCode":"import { Component } from '@angular/core';\r\n\r\nimport { NzUploadFile } from 'ng-zorro-antd/upload';\r\n\r\nconst getBase64 = (file: File): Promise<string | ArrayBuffer | null> =>\r\n  new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => resolve(reader.result);\r\n    reader.onerror = error => reject(error);\r\n  });\r\n\r\n@Component({\r\n  selector: 'nz-demo-upload-picture-card',\r\n  template: `\r\n    <div class=\"clearfix\">\r\n      <nz-upload\r\n        nzAction=\"https://www.mocky.io/v2/5cc8019d300000980a055e76\"\r\n        nzListType=\"picture-card\"\r\n        [(nzFileList)]=\"fileList\"\r\n        [nzShowButton]=\"fileList.length < 8\"\r\n        [nzPreview]=\"handlePreview\"\r\n      >\r\n        <div>\r\n          <span nz-icon nzType=\"plus\"></span>\r\n          <div style=\"margin-top: 8px\">Upload</div>\r\n        </div>\r\n      </nz-upload>\r\n      <nz-modal\r\n        [nzVisible]=\"previewVisible\"\r\n        [nzContent]=\"modalContent\"\r\n        [nzFooter]=\"null\"\r\n        (nzOnCancel)=\"previewVisible = false\"\r\n      >\r\n        <ng-template #modalContent>\r\n          <img [src]=\"previewImage\" [ngStyle]=\"{ width: '100%' }\" />\r\n        </ng-template>\r\n      </nz-modal>\r\n    </div>\r\n  `\r\n})\r\nexport class NzDemoUploadPictureCardComponent {\r\n  fileList: NzUploadFile[] = [\r\n    {\r\n      uid: '-1',\r\n      name: 'image.png',\r\n      status: 'done',\r\n      url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png'\r\n    },\r\n    {\r\n      uid: '-2',\r\n      name: 'image.png',\r\n      status: 'done',\r\n      url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png'\r\n    },\r\n    {\r\n      uid: '-3',\r\n      name: 'image.png',\r\n      status: 'done',\r\n      url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png'\r\n    },\r\n    {\r\n      uid: '-4',\r\n      name: 'image.png',\r\n      status: 'done',\r\n      url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png'\r\n    },\r\n    {\r\n      uid: '-xxx',\r\n      percent: 50,\r\n      name: 'image.png',\r\n      status: 'uploading',\r\n      url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png'\r\n    },\r\n    {\r\n      uid: '-5',\r\n      name: 'image.png',\r\n      status: 'error'\r\n    }\r\n  ];\r\n  previewImage: string | undefined = '';\r\n  previewVisible = false;\r\n\r\n  handlePreview = async (file: NzUploadFile): Promise<void> => {\r\n    if (!file.url && !file.preview) {\r\n      file.preview = await getBase64(file.originFileObj!);\r\n    }\r\n    this.previewImage = file.url || file.preview;\r\n    this.previewVisible = true;\r\n  };\r\n}\r\n"}
